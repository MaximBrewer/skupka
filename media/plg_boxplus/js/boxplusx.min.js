(function(){/*
 boxplusx: a versatile lightweight pop-up window engine
 @author  Levente Hunyadi
 @version 1.0
 @remarks Copyright (C) 2009-2017 Levente Hunyadi
 @remarks Licensed under GNU/GPLv3, see http://www.gnu.org/licenses/gpl-3.0.html
 @see     http://hunyadi.info.hu/projects/boxplusx
*/
'use strict';var aa="function"==typeof Object.defineProperties?Object.defineProperty:function(d,g,m){d!=Array.prototype&&d!=Object.prototype&&(d[g]=m.value)},ba="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function ca(d){if(d){for(var g=ba,m=["Object","assign"],k=0;k<m.length-1;k++){var v=m[k];v in g||(g[v]={});g=g[v]}m=m[m.length-1];k=g[m];d=d(k);d!=k&&null!=d&&aa(g,m,{configurable:!0,writable:!0,value:d})}}
ca(function(d){return d?d:function(d,m){for(var k=1;k<arguments.length;k++){var g=arguments[k];if(g)for(var u in g)Object.prototype.hasOwnProperty.call(g,u)&&(d[u]=g[u])}return d}});var da={id:null,slideshow:0,autostart:!1,loop:!1,preferredWidth:800,preferredHeight:600,navigation:"bottom",controls:"below",captions:"below",contextmenu:!0,metadata:!1,dir:"ltr"};
function ea(d,g){function m(){k=!1}var k=!1,v=0,u=0;d.addEventListener("mousedown",function(d){v=d.clientX;u=d.clientY;k=!0;d.preventDefault()});d.addEventListener("mouseup",m);d.addEventListener("mouseout",m);d.addEventListener("mousemove",function(d){k&&(g.scrollLeft-=d.clientX-v,g.scrollTop-=d.clientY-u,v=d.clientX,u=d.clientY)})}
(function(){function d(a){this.P(a)}function g(){}function m(a){var b={};1<a.length&&a.substr(1).split("&").forEach(function(a){var c=a.indexOf("="),q=0<=c?a.substr(c+1):"";b[decodeURIComponent(0<=c?a.substr(0,c):a)]=decodeURIComponent(q)});return b}function k(a){var b=document.createElement("a");b.href=a;a=b.hash.indexOf("!");return{protocol:b.protocol,host:b.host,hostname:b.hostname,port:b.port,pathname:b.pathname,search:b.search,T:m(b.search),hash:b.hash,id:b.hash.substr(1,(0<=a?a:b.hash.length)-
1),S:m(b.hash.substr(Math.max(0,a)))}}function v(a){a=k(a);var b=k(location.href);return a.protocol===b.protocol&&a.host===b.host&&a.pathname===b.pathname&&a.search===b.search}function u(a){return Object.keys(a).map(function(b){return encodeURIComponent(b)+"="+encodeURIComponent(a[b])}).join("&")}function fa(a,b){a=a||{};for(var c in JSON.parse(JSON.stringify(b)))a[c]=a[c]||b[c];return a}function F(a,b){return a.hasAttribute(b)?a.getAttribute(b):null}function P(a){var b=document.createElement("textarea");
b.innerHTML=a;return b.value}function n(a,b){b?a.classList.remove("boxplusx-hidden"):a.classList.add("boxplusx-hidden")}function D(a){return!a.classList.contains("boxplusx-hidden")}function t(a,b,c){var f=document.createElement("div");f.classList.add("boxplusx-"+a);b&&f.classList.add("boxplusx-hidden");c&&c.forEach(function(a){f.appendChild(a)});return f}function I(a){return a.map(function(a){return t(a)})}function ha(a,b){if(/\.jpe?g$/i.test(a)){var c=new XMLHttpRequest;c.open("get",a);c.responseType=
"blob";c.onload=function(){ia(c.response,b)};c.send()}else b(-2)}function ia(a,b){var c=new FileReader;c.onload=function(){var a=new DataView(c.result);if(65496!=a.getUint16(0))b(-2);else{for(var q=a.byteLength,e=2;e<q;){var l=a.getUint16(e);e+=2;if(65505==l){if(1165519206!=a.getUint32(e+=2)){b(-1);return}l=18761==a.getUint16(e+=6);e+=a.getUint32(e+4,l);var d=a.getUint16(e,l);e+=2;for(var p=0;p<d;p++)if(274==a.getUint16(e+12*p,l))return b(a.getUint16(e+12*p+8,l))}else if(65280!=(l&65280))break;else e+=
a.getUint16(e)}return b(-1)}};c.readAsArrayBuffer(a)}function ja(a){return[].slice.call(a).map(function(a){a:{if(null!==a&&"a"===a.tagName.toLowerCase()){var b=F(a,"data-title");if(null!==b){b=P(b);break a}if(b=a.querySelector("img"))if(b=F(b,"alt"),null!==b)break a}b=""}a:{if(null!==a&&"a"===a.tagName.toLowerCase()){var f=F(a,"data-summary");if(null!==f){f=P(f);break a}f=F(a,"title");if(null!==f)break a}f=""}b===f&&(f="");var q="";null!==a&&"a"===a.tagName.toLowerCase()&&(q=a.href);var e=a.dataset&&
a.dataset.download||"",d;a=a.getElementsByTagName("img");0<a.length&&(d=a[0]);return{url:q,image:d,title:b,description:f,download:e}})}function w(a,b){a=this.f.querySelectorAll(".boxplusx-"+a);for(var c=0;c<a.length;++c)b(a[c])}function J(a,b){var c=this;Object.keys(b).forEach(function(f){w.call(c,f,function(q){q.addEventListener(a,b[f].bind(c),!1)})})}function Q(a){switch(a){case 0:case 1:return!1}return!0}function x(a){function b(a){switch(a){case 0:return"unavailable";case 1:return"image";case 2:return"video";
case 3:return"embed";case 4:return"document";case 5:return"frame";default:return"none"}}var c=this.s.classList;c.remove("boxplusx-"+b(this.C));c.remove("boxplusx-interactive");this.C=a;c.add("boxplusx-"+b(a));Q(a)&&c.add("boxplusx-interactive")}function K(){var a=this,b=A.call(this),c=this.a.loop,f=0==b,q=this.i,e=b>=q.length-1,d=0<this.a.slideshow;w.call(this,"previous",function(a){n(a,c||!f)});w.call(this,"next",function(a){n(a,c||!e)});w.call(this,"start",function(b){n(b,d&&!a.l&&!e)});w.call(this,
"stop",function(b){n(b,d&&a.l)});w.call(this,"download",function(a){n(a,!!q[b].download)});w.call(this,"metadata",function(b){var c;if(c=a.a.metadata)c=!!a.f.querySelector(".boxplusx-detail");n(b,c)})}function R(){n(this.D,(this.c>this.viewport.clientWidth||this.g>this.viewport.clientHeight)&&!Q(this.C));var a=this.D.classList;this.m?a.remove("boxplusx-collapse"):a.add("boxplusx-collapse");a=this.D.classList;this.m?a.add("boxplusx-expand"):a.remove("boxplusx-expand")}function S(){L.call(this);T.call(this);
x.call(this,-1);for(var a=this.b;a.hasChildNodes();)a.removeChild(a.lastChild);n(this.w,!1);n(this.h,!1)}function A(){return this.j[this.j.length-1]}function y(a,b,c){function f(){D(r.h)&&(p.setProperty("max-width",l),L.call(r),n(r.F,!1),A.call(r)>=r.i.length-1&&(r.l=!1),K.call(r),n(r.w,!0),U.call(r),R.call(r),r.l&&V.call(r))}this.v=a;var d=window.getComputedStyle(this.f);b=b||d.getPropertyValue("width");c=c||d.getPropertyValue("height");L.call(this);n(this.w,!0);var e=this.viewport.classList;e.remove("boxplusx-fixedaspect");
e.remove("boxplusx-draggable");1===a||2===a?(a=this.G.style,a.setProperty("width",this.c+"px"),a.setProperty("padding-top",100*this.g/this.c+"%"),e.add("boxplusx-fixedaspect")):4===a?e.add("boxplusx-draggable"):3===a&&(a=this.s.style,a.setProperty("width",this.c+"px"),a.setProperty("max-height",this.g+"px"));W.call(this);a=d.getPropertyValue("width");e=d.getPropertyValue("height");var l=d.getPropertyValue("max-width"),r=this,p=this.f.style;b!=a||c!=e?(n(this.w,!1),p.removeProperty("max-width"),p.setProperty("width",
b),p.setProperty("height",c),this.f.classList.add("boxplusx-animation"),d=Math.max.apply(null,d.getPropertyValue("transition-duration").split(",").map(function(a){var b=parseFloat(a);return/\ds$/.test(a)?1E3*b:b})),window.setTimeout(f,d)):f();p.setProperty("width",a);p.setProperty("height",e)}function L(){this.f.classList.remove("boxplusx-animation");var a=this.f.style;a.removeProperty("width");a.removeProperty("height")}function X(a,b,c){function d(a){c(a);return q.f.offsetHeight}var q=this,e=this.h.clientHeight,
l=d(b);if(l<=e)return b;l=d(a);if(l>=e)return c(b),b;for(var r=1;10>r;++r){l=(a+b)/2|0;var p=d(l);p<e?a=l:b=l;l=p}c(a);return a}function W(){if(2===this.v){var a=this.f.style;X.call(this,0,1E3,function(b){a.setProperty("max-width",b/10+"%")})}else if(4===this.v||3===this.v){var b=this.s.style;b.removeProperty("max-height");var c=X.call(this,0,window.innerHeight,function(a){b.setProperty("height",a+"px")});b.removeProperty("height");b.setProperty("max-height",Math.min(c,this.g)+"px")}}function ka(a,
b){var c=a.src;if(/^file:/.test(c))b(-3);else{var d=window.EXIF;this.a.metadata&&d?d.getData(a,function(){var c=0,d=Object.assign({},a.iptcdata,a.exifdata);if(0<Object.keys(d).length){var f=d;(d=d.Orientation)&&(c=+d)}b(c,f)}):ha(c,function(a){b(a)})}}function M(a){var b=this,c=this.i[a];this.j.push(a);var d=window.getComputedStyle(this.f),q=d.getPropertyValue("width"),e=d.getPropertyValue("height");G.call(this);n(this.F,!0);var l=c.title,r=c.description;c=c.url;d=k(c);var p=d.pathname,g=Object.assign({},
d.T,d.S);this.c=parseInt(g.width,10)||this.a.preferredWidth;this.g=parseInt(g.height,10)||this.a.preferredHeight;if(v(c))(a=document.getElementById(d.id?d.id:g.target))?(a=a.cloneNode(!0),B.call(this,a,l,r),x.call(this,4),y.call(this,3,q,e)):N.call(this);else if(/\.(gif|jpe?g|png|svg)$/i.test(p)){var m=document.createElement("img");m.addEventListener("load",function(){ka.call(b,m,function(a,c){var d=document.createDocumentFragment(),f=document.createElement("div"),p=document.createElement("div");
0<a&&p.classList.add("boxplusx-orientation-"+a);var g=p.style;g.setProperty("background-image",'url("'+m.src+'")');var k=window.devicePixelRatio||1,C=m.naturalHeight/k;k=m.naturalWidth/k;5<=a&&8>=a?(b.c=C,b.g=k,g.setProperty("width",100*k/C+"%"),g.setProperty("height",100*C/k+"%")):(b.c=k,b.g=C,g.removeProperty("width"),g.removeProperty("height"));b.m||(a=f.style,a.setProperty("width",b.c+"px"),a.setProperty("height",b.g+"px"));f.appendChild(p);d.appendChild(f);if(c){f=t("detail",!0);p=document.createElement("table");
a=Object.keys(c);g=a.length;a.sort();for(C=0;C<g;++C){k=a[C];var O=document.createElement("tr"),n=document.createElement("td");n.innerText=k;var z=document.createElement("td");z.innerText=c[k];O.appendChild(n);O.appendChild(z);p.appendChild(O)}f.appendChild(p);d.appendChild(f)}B.call(b,d,l,r);b.J.style.setProperty("max-width",b.c+"px");x.call(b,1);y.call(b,b.m?2:4,q,e)})},!1);m.addEventListener("error",N.bind(this),!1);m.src=c;a<b.i.length-1&&(a=b.i[a+1].url,c=k(a),/\.(gif|jpe?g|png|svg)$/i.test(c.pathname)&&
(document.createElement("img").src=a))}else if(/\.(mov|mpe?g|mp4|ogg|webm)$/i.test(p)){var z=document.createElement("video");z.controls=!0;z.addEventListener("loadedmetadata",function(){B.call(b,z,l,r);x.call(b,2);b.c=z.videoWidth;b.g=z.videoHeight;y.call(b,2,q,e)},!1);z.addEventListener("error",N.bind(this),!1);z.src=c}else/\.pdf$/.test(p)?(a=document.createElement("embed"),a.src=c,a.type="application/pdf",B.call(b,a,l,r),x.call(b,3),y.call(b,2,q,e)):(a=/^https?:\/\/(?:www\.)youtu(?:\.be|be\.com)\/(?:embed\/|watch\?v=|v\/|)([-_0-9A-Z]{11,})/i.exec(c),
null!==a?Y.call(this,"https://www.youtube.com/embed/"+a[1]+"?"+u({rel:"0",controls:"1",U:"0"}),l,r):Y.call(this,c,l,r))}function T(){for(var a=this.s;a.hasChildNodes();)a.removeChild(a.lastChild);a=this.f.style;var b=this.G.style,c=this.s.style;b.removeProperty("padding-top");b.removeProperty("width");c.removeProperty("width");a.removeProperty("max-width");c.removeProperty("max-height")}function B(a,b,c){T.call(this);this.s.appendChild(a);this.J.style.removeProperty("max-width");this.O.innerHTML=
b;this.N.innerHTML=c}function N(){x.call(this,0);y.call(this,2)}function Y(a,b,c){var d=this,q=document.createElement("iframe");q.width=""+this.c;q.height=""+this.g;q.src=a;B.call(this,q,b,c);var e=!1;q.addEventListener("load",function(){e||(e=!0,x.call(d,5),y.call(d,1))},!1)}function V(){G.call(this);this.A=window.setTimeout(this.next.bind(this),this.a.slideshow)}function G(){this.A&&(window.clearTimeout(this.A),this.A=null)}function E(a){switch(this.a.dir){case "rtl":return a.offsetParent.offsetWidth-
a.offsetWidth-a.offsetLeft;default:return a.offsetLeft}}function H(a,b){var c=this.b.style;c.setProperty("rtl"==this.a.dir?"right":"left",-a+"px");c.setProperty("transition-duration",5*b+"ms")}function U(){if(D(this.u)){for(var a=0;a<this.b.childNodes.length;++a)this.b.childNodes[a].classList.remove("boxplusx-current");var b=Math.max(this.b.offsetWidth-this.u.offsetWidth,0),c=this.b.childNodes[A.call(this)];c.classList.add("boxplusx-current");a=-E.call(this,this.b);var d=E.call(this,c);b=Math.min(b,
d);a>b&&(a=b);c=Math.max(0,d-this.u.offsetWidth+c.offsetWidth);a<c&&(a=c);H.call(this,a,0)}}function la(){var a=Math.max(this.b.offsetWidth-this.u.offsetWidth,0);H.call(this,0,a-(a- -E.call(this,this.b)))}function ma(){var a=Math.max(this.b.offsetWidth-this.u.offsetWidth,0);H.call(this,a,a- -E.call(this,this.b))}function Z(){H.call(this,-E.call(this,this.b),0)}window.BoxPlusXDialog=d;g.prototype.H="boxplusx";d.prototype.bind=function(a){function b(a){c.K(d,a)}var c=this;a=[].slice.call(a);var d=ja(a);
a.forEach(function(a,c){a.addEventListener("click",function(a){a.preventDefault();b(c)},!1)});return b};d.prototype.P=function(a){function b(){if(h.c>h.viewport.clientWidth||h.g>h.viewport.clientHeight)h.m=!h.m,M.call(h,A.call(h))}this.a=fa(a,da);a=t("aspect");var c=t("content"),d=t("expander"),q=t("navbar"),e=t("navigation",!1,[q].concat(I(["rewind","forward"]))),l=t("viewport",!1,[a,c,d].concat(I(["previous","next"]))),g=t("controls",!1,I("previous next close start stop download metadata".split(" "))),
p=t("title"),k=t("description"),m=t("caption",!1,[p,k]),n=t("wrapper",!1,[l,e]);n=t("wrapper",!1,[n,g]);n=t("wrapper",!0,[n,m]);var v=t("progress",!0),u=t("dialog",!1,[n,v]),w=t("container",!0,[u]);this.a.id&&(w.id=this.a.id);m.classList.add("boxplusx-"+this.a.captions);g.classList.add("boxplusx-"+this.a.controls);e.classList.add("boxplusx-"+this.a.navigation);document.body.appendChild(w);this.h=w;this.f=u;this.w=n;this.viewport=l;this.J=m;this.O=p;this.N=k;this.G=a;this.s=c;this.D=d;this.u=e;this.b=
q;this.F=v;this.i=[];this.j=[];this.A=null;this.l=!1;this.v=2;this.c=this.a.c;this.g=this.a.g;this.C=-1;this.m=!0;var h=this;this.h.addEventListener("click",function(a){a.target===h.h&&h.close.call(h)},!1);J.call(this,"click",{previous:this.B,next:this.next,close:this.close,start:this.start,stop:this.M,metadata:this.R,download:this.download});J.call(this,"mouseover",{rewind:la,forward:ma});J.call(this,"mouseout",{rewind:Z,forward:Z});this.a.contextmenu||u.addEventListener("contextmenu",function(a){a.preventDefault()});
var x=this.a.dir;this.h.dir=x;new ea(l,c);d.addEventListener("click",b);l.addEventListener("dblclick",b);c.addEventListener("mousewheel",function(a){var b="hidden"!=window.getComputedStyle(c).overflowY,d=c.scrollHeight-c.clientHeight;if(b&&0<d){b=c.scrollTop;var e=a.deltaY;(b===d&&0<e||0===b&&0>e)&&a.preventDefault()}});window.addEventListener("keydown",function(a){var b;if(b=D(h.h)){b=a.target;var c=["input","select","textarea"];b=!(null!==b&&0<=c.indexOf(b.tagName.toLowerCase()))}if(b){b=[27,36,
35];switch(x){case "ltr":b.push(37,39);break;case "rtl":b.push(39,37)}b=b.indexOf(a.which||a.keyCode);0<=b&&([h.close,h.first,h.I,h.B,h.next][b].call(h),a.preventDefault())}},!1);var y,B=0;l.addEventListener("touchstart",function(a){y=a.changedTouches[0].pageX});l.addEventListener("touchend",function(a){var b=(new Date).getTime(),c=b-B;0<c&&500>c?a.preventDefault():h.m&&(a=a.changedTouches[0].pageX,50<=a-y?h.B.call(h):50<=y-a&&h.next.call(h));B=b});window.addEventListener("popstate",function(){if(D(h.h))if(h.j.pop(),
0<h.j.length){window.history.pushState({H:"boxplusx"},"");var a=A.call(h);h.j.pop();M.call(h,a)}else S.call(h)},!1);window.addEventListener("resize",function(){D(h.h)&&(W.call(h),U.call(h),R.call(h))})};d.prototype.K=function(a,b){this.i=a;var c=this,d=1<a.length&&"hidden"!=this.a.navigation;n(this.u,d);d&&a.forEach(function(a,b){var d=t("aspect"),e=t("navimage"),g=t("navitem",!1,[d,e]);g.addEventListener("click",c.o.bind(c,b),!1);var f=a.image;f&&(a=function(){var a=d.style;a.setProperty("width",
f.naturalWidth+"px");a.setProperty("padding-top",100*f.naturalHeight/f.naturalWidth+"%");e.style.setProperty("background-image",'url("'+f.src+'")')},f.src&&f.complete?a():(f.addEventListener("load",a),f.preloader&&(a=f.preloader,a.load&&a.load())));e.innerText=b+1+"";c.b.appendChild(g)});this.L(b)};d.prototype.L=function(a){this.j=[];window.history.state&&"boxplusx"===window.history.state.H?window.history.replaceState(new g,""):window.history.pushState(new g,"");this.a.autostart&&0<this.a.slideshow&&
(this.l=!0);n(this.h,!0);n(this.F,!0);this.o(a)};d.prototype.close=function(){G.call(this);S.call(this);this.j=[];window.history.go(-1)};d.prototype.o=function(a){a!=A.call(this)&&M.call(this,a)};d.prototype.first=function(){this.o(0)};d.prototype.B=function(){var a=A.call(this);0<a?this.o(a-1):this.a.loop&&this.I()};d.prototype.next=function(){var a=A.call(this);a<this.i.length-1?this.o(a+1):this.a.loop&&this.first()};d.prototype.I=function(){this.o(this.i.length-1)};d.prototype.start=function(){0<
this.a.slideshow&&(this.l=!0,V.call(this),K.call(this))};d.prototype.M=function(){0<this.a.slideshow&&(this.l=!1,G.call(this),K.call(this))};d.prototype.R=function(){var a=this.f.querySelector(".boxplusx-detail");a&&n(a,!D(a))};d.prototype.download=function(){var a=document.createElement("a");a.href=this.i[A.call(this)].download;document.body.appendChild(a);a.click();document.body.removeChild(a)};d.discover=function(a,b,c){b=b||"boxplusx";var f=new d(c),g=function(a){var b={};[].forEach.call(a,function(a){var c=
a.getAttribute("rel");Object.prototype.hasOwnProperty.call(b,c)||(b[c]=[]);b[c].push(a)});return b}(document.querySelectorAll("a[href][rel^="+b+"]:not([rel="+b+"])"));Object.keys(g).forEach(function(a){f.bind(g[a])});[].filter.call(document.querySelectorAll("a[href][rel="+b+"]"),function(a){f.bind([a])});a||[].filter.call(document.querySelectorAll("a[href]:not([rel^="+b+"])"),function(a){return/\.(gif|jpe?g|png|svg|mov|mpe?g|ogg|webm)$/i.test(a.pathname)&&!a.target}).forEach(function(a){f.bind([a])})}})();}).call(this);
