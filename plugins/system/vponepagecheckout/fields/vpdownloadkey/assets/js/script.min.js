/*--------------------------------------------------------------------------------------------------------
# Copyright:     Copyright (C) 2012-2017 VirtuePlanet Services LLP. All Rights Reserved.
# License:       VirtuePlanet Proprietary License - https://www.virtueplanet.com/policies/licenses
# Author:        Abhishek Das
# Email:         info@virtueplanet.com
# Websites:      http://www.virtueplanet.com
----------------------------------------------------------------------------------------------------------
$Revision: 3 $
$LastChangedDate: 2017-09-20 20:00:08 +0530 (Wed, 20 Sep 2017) $
$Id: script.min.js 3 2017-09-20 14:30:08Z Abhshek Das $
----------------------------------------------------------------------------------------------------------*/
!function(a){a(function(){var b=window.vpdk||{};b.showTimeout=null,b.hideTimeout=null,b.ajaxTimeout=null,b.modalBg=a('<div class="vpdk-modal-bg"></div>'),b.modalBg.appendTo('body'),b.show=function(c){b.showTimeout&&clearTimeout(b.showTimeout),a('body').addClass('vpdk-modal-open'),b.modalBg.addClass('vpdk-fade'),c.addClass('vpdk-fade'),b.showTimeout=setTimeout(function(){b.modalBg.addClass('vpdk-in'),c.addClass('vpdk-in')},20)},b.hide=function(c){b.hideTimeout&&clearTimeout(b.hideTimeout),a('body').removeClass('vpdk-modal-open'),b.modalBg.removeClass('vpdk-in'),c.removeClass('vpdk-in'),b.hideTimeout=setTimeout(function(){b.modalBg.removeClass('vpdk-fade'),c.removeClass('vpdk-fade')},150)},b.showMsg=function(c,d,f){d=d?d:'error';var g=a('<div class="vpdk-alert vpdk-alert-'+d+'"></div>');g.html(f),c.html(g)},b.hideMsg=function(c){c.text('')},b.showSystemMsg=function(c,d){c=c?c:'error';var f=a('<div class="vpdk-alert vpdk-alert-'+c+'"></div>');f.html(d),a('div#system-message-container').html(f),a('html,body').animate({scrollTop:a('div#system-message-container').offset().top-100},500)},b.hideSystemMsg=function(){a('div#system-message-container').text('')},a('[data-vpdk]').each(function(){var c=b;c.field=a(this),c.parentForm=a(this).closest('form'),c.actionURL=c.parentForm.attr('action'),c.id=c.field.attr('id'),c.btn=a('button#'+c.id+'-button'),c.clearBtn=a('button#'+c.id+'-clear-button'),c.revalBtn=a('button#'+c.id+'-reval-button'),c.enableBtn=a('button#'+c.id+'-enable-button'),c.tmpl=a('script#'+c.id+'-tmpl'),c.html=a(c.tmpl.html()),c.html.appendTo('body'),c.tmpl.remove(),c.hiddenField=a('input#'+c.id+'-hidden'),c.modal=a('#'+c.id+'-tmpl-modal'),c.form=c.modal.find('form'),c.msgBox=c.modal.find('.vpdk-modal-message'),c.unameField=c.form.find('input#'+c.id+'-tmpl-uname'),c.dlkField=c.form.find('input#'+c.id+'-tmpl-dlk'),c.confBtn=c.form.find('button#'+c.id+'-tmpl-button'),c.cancelBtn=c.form.find('button#'+c.id+'-tmpl-cancel'),c.closeBtn=c.modal.find('button.vpdk-modal-close'),c.url=c.form.data('action'),c.modalLoader=c.modal.find('.vpdk-modal-inner-bg'),c.infoNoaccess=c.field.siblings('.vpdk-info-box').find('.vpdk-info-noaccess'),c.infoValid=c.field.siblings('.vpdk-info-box').find('.vpdk-info-valid'),c.infoDefault=c.field.siblings('.vpdk-info-box').find('.vpdk-info-default'),c.btn.click(function(d){return d.preventDefault(),b.show(c.modal),b.hideSystemMsg(),!1}),c.clearBtn.click(function(d){return d.preventDefault(),c.field.val('***').trigger('change'),c.hiddenField.val('***').trigger('change'),b.hideSystemMsg(),!1}),c.field.change(function(){''==a(this).val()?(c.btn.removeClass('vpdk-show-edit'),c.clearBtn.addClass('vpdk-hide'),c.revalBtn.addClass('vpdk-hide'),c.infoValid.addClass('vpdk-hide'),c.infoNoaccess.addClass('vpdk-hide'),c.infoDefault.removeClass('vpdk-hide')):(c.btn.addClass('vpdk-show-edit'),c.clearBtn.removeClass('vpdk-hide'),c.revalBtn.removeClass('vpdk-hide'),'0'==a(this).data('vpdkaccess')?(c.infoNoaccess.removeClass('vpdk-hide'),c.infoDefault.addClass('vpdk-hide'),c.infoValid.addClass('vpdk-hide')):(c.infoDefault.addClass('vpdk-hide'),c.infoNoaccess.addClass('vpdk-hide'),c.infoValid.removeClass('vpdk-hide')))}),c.cancelBtn.click(function(){b.hideMsg(c.msgBox),b.hide(c.modal),b.hideSystemMsg()}),c.closeBtn.click(function(){b.hideMsg(c.msgBox),b.hide(c.modal),b.hideSystemMsg()}),c.enableBtn.click(function(){b.ajaxTimeout&&clearTimeout(b.ajaxTimeout);var d={cid:[c.enableBtn.data('extensionid')],task:'plugins.publish',option:'com_plugins'},f=c.enableBtn.data('token');d[f]=1,b.ajaxTimeout=a.ajax({type:'POST',dataType:'HTML',url:c.enableBtn.data('root')+'/index.php?option=com_plugins',cache:!1,data:d,beforeSend:function(){c.enableBtn.attr('disabled',!0)},success:function(){window.location.href=c.enableBtn.data('root')+'/index.php?option=com_plugins&task=plugin.edit&extension_id='+c.enableBtn.data('extensionid')}})}),c.confBtn.click(function(){return b.hideMsg(c.msgBox),c.uname=c.unameField.val(),c.uname=c.uname?a.trim(c.uname):c.uname,c.dlk=c.dlkField.val(),c.dlk=c.dlk?a.trim(c.dlk):c.dlk,c.timeOut,c.uname?c.dlk?void(b.ajaxTimeout&&clearTimeout(b.ajaxTimeout),b.ajaxTimeout=a.ajax({type:'GET',dataType:'JSON',url:c.url,cache:!1,data:{method:'validatedlk',uname:encodeURIComponent(c.uname),dlk:encodeURIComponent(c.dlk)},beforeSend:function(){c.modalLoader.addClass('vpdk-fade').addClass('vpdk-in')},success:function(d){return c.modalLoader.removeClass('vpdk-fade').removeClass('vpdk-in'),d?d.error?(b.showMsg(c.msgBox,'error',d.msg),!1):d.return.valid?void(d.return.access?(b.showMsg(c.msgBox,'success',d.return.message),c.field.data('vpdkaccess','1').attr('data-vpdkaccess','1')):(b.showMsg(c.msgBox,'warning',d.return.message),c.field.data('vpdkaccess','0').attr('data-vpdkaccess','0')),c.field.val(d.return.dlk).trigger('change'),c.hiddenField.val(d.return.data).trigger('change'),c.timeOut&&clearTimeout(c.timeOut),c.timeOut=setTimeout(function(){b.hide(c.modal),c.form[0].reset(),b.hideMsg(c.msgBox)},500)):(b.showMsg(c.msgBox,'error',d.return.message),c.field.val('').trigger('change'),c.hiddenField.val('').trigger('change'),c.field.data('vpdkaccess','0').attr('data-vpdkaccess','0'),!1):(b.showMsg(c.msgBox,'error','Validation failed. Please check your internet connection. If problem persists please contact VirtuePlanet support.'),!1)},error:function(d,f,g){console.log(d),console.log(f),console.log(g),c.modalLoader.removeClass('vpdk-fade').removeClass('vpdk-in'),b.showMsg(c.msgBox,'warning','Validation failed. Please check your internet connection. If problem persists please contact VirtuePlanet support.')}})):(b.showMsg(c.msgBox,'error','Please provide a valid Download Key.'),!1):(b.showMsg(c.msgBox,'error','Please provide a valid Username.'),!1)}),c.revalBtn.click(function(){b.hideSystemMsg(),b.ajaxTimeout&&clearTimeout(b.ajaxTimeout),b.ajaxTimeout=a.ajax({type:'GET',dataType:'JSON',url:c.url,cache:!1,data:{method:'revalidatedlk',data:c.hiddenField.val()},beforeSend:function(){c.revalBtn.attr('disabled',!0)},success:function(d){return c.revalBtn.removeAttr('disabled'),d?d.error?(b.showSystemMsg('error',d.msg),c.field.val('').trigger('change'),c.hiddenField.val('').trigger('change'),c.field.data('vpdkaccess','0').attr('data-vpdkaccess','0'),!1):d.return.valid?void(d.return.access?(b.showSystemMsg('success',d.return.message),c.field.data('vpdkaccess','1').attr('data-vpdkaccess','1')):(b.showSystemMsg('warning',d.return.message),c.field.data('vpdkaccess','0').attr('data-vpdkaccess','0')),c.field.val(d.return.dlk).trigger('change'),c.hiddenField.val(d.return.data).trigger('change')):(b.showSystemMsg('error',d.return.message),c.field.val('').trigger('change'),c.hiddenField.val('').trigger('change'),c.field.data('vpdkaccess','0').attr('data-vpdkaccess','0'),!1):(b.showSystemMsg('error','Validation failed. Please check your internet connection. If problem persists please contact VirtuePlanet support.'),!1)},error:function(d,f,g){console.log(d),console.log(f),console.log(g),c.revalBtn.removeAttr('disabled'),b.showSystemMsg('warning','Validation failed. Please check your internet connection. If problem persists please contact VirtuePlanet support.')}})}),'auto'==c.revalBtn.data('vpdkvalidate')&&c.revalBtn.trigger('click')})})}(jQuery);